<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Attendance</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 0;
            transition: background 0.3s; /* Smooth transition for background color */
            color: #fff;
            background: linear-gradient(to right, #fd876a, #418eed);
            background-repeat: no-repeat;
            background-size: cover;

        }

        /* Keyframe Animation for Fade In */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Keyframe Animation for Slide In */
        @keyframes slideIn {
            from { transform: translateY(-20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .container {
    max-width: 600px;
    margin: 0 auto;
    background: rgba(0, 0, 0, 0.7); 
    border-radius: 15px; 
    padding: 20px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5); 
    transition: transform 0.3s, box-shadow 0.3s;
    
}
.container:hover {
    transform: translateY(-5px); 
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.7); 
}
       
        h2 {
            text-align: center;
            font-size: 2.5em;
            margin-bottom: 20px;
            animation: fadeIn 1s; 
            color: #007bff;/* Fade-in effect */
        }
        
        #welcomeMessage {
            font-size: 32px;
            color: #a90ca4;
            animation: slideIn 1s ease-out, glow 1.5s ease-in-out infinite alternate;
            text-shadow: 0px 0px 10px rgb(158, 6, 6);
        }

        @keyframes glow {
            from { text-shadow: 0px 0px 10px rgb(5, 101, 139); }
            to { text-shadow: 0px 0px 20px rgb(93, 5, 99) }
        }

h1{
    color: cadetblue;
    text-align: center;
}
        h1:hover {
            color: #000000; /* Darker gold shade on hover */
        }

        .buttons {
            margin-bottom: 30px;
        }

        .tech{
            padding: 12px 25px;
            font-size: 16px;
            margin: 10px;
            cursor: pointer;
            background-color: #57020a; /* Vibrant coral button color */
            border: none; /* Remove default border */
            border-radius: 5px; /* Rounded corners */
            transition: background-color 0.3s, transform 0.2s; /* Smooth transition for hover effect */
            animation: slideIn 0.5s ease-in-out; /* Slide in animation for buttons */
            color: #fff; /* Button text color */
            font-weight: bold; 
            margin-left: 25px;/* Bold text for buttons */
        }
        .itech{
            padding: 12px 25px;
            font-size: 16px;
            margin: 10px;
            cursor: pointer;
            background-color: #57020a; /* Vibrant coral button color */
            border: none; /* Remove default border */
            border-radius: 5px; /* Rounded corners */
            transition: background-color 0.3s, transform 0.2s; /* Smooth transition for hover effect */
            animation: slideIn 0.5s ease-in-out; /* Slide in animation for buttons */
            color: #fff; /* Button text color */
            font-weight: bold; /* Bold text for buttons */
            margin-left: 250px;
        }
        button:hover {
            background-color: #03326c; /* Darker shade on hover */
            transform: scale(1.05); /* Scale up button on hover */
        }

        .topics-section {
            display: flex;
            padding: 0 20px;
            height: calc(100vh - 160px); /* Full height minus the space for header and buttons */
            transition: height 0.3s; /* Smooth transition for height */
        }

        .topics-list {
            list-style-type: none;
            padding: 0;
            width: 200px; /* Set a fixed width for the topics list */
            margin-right: 20px;
            animation: slideIn 0.5s ease-in-out; /* Slide in animation for topics list */
        }

        .topics-list li {
            margin: 5px 0;
            padding: 15px; /* Increased padding for better touch targets */
            background-color: rgba(125, 13, 13, 0.558); /* Light background with transparency */
            border-radius: 10px; /* Rounded corners */
            cursor: pointer;
            transition: background-color 0.3s, transform 0.2s; /* Smooth transition for hover effect */
            color: #0a0a0a; /* White text for topics */
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5); /* Subtle shadow for text */
        }

        .topics-list li:hover {
            background-color: rgba(255, 255, 255, 0.4); /* Change background on hover */
            transform: scale(1.03); /* Slightly scale the list item on hover */
        }

        .table-container {
            display: none;
            flex-grow: 1; /* This will make the table take up the remaining space */
            overflow: auto; /* To handle scrolling if the table gets too large */
            transition: opacity 0.3s; /* Smooth transition for table visibility */
            animation: fadeIn 1s ease-in; /* Fade in animation for the table */
            background-color: rgb(137, 131, 131); /* Semi-transparent background for the table container */
            border-radius: 10px; /* Rounded corners */
            padding: 20px;
            margin-top: 10px; /* Padding inside table container */
        }

        table {
            width: 100%;
            border-collapse: collapse;
            transition: transform 0.3s; /* Smooth transition for table appearance */
        }

        table, th, td {
            border: 1px solid #fff; /* White border for table */
        }

        th {
            background-color: #4d604d; /* Set header color */
            color: #fff; /* Set header text color to white for contrast */
        }

        th, td {
            padding: 12px;
            text-align: center;
        }

        td {
            background-color: rgba(32, 15, 143, 0.662); /* Light background for table data cells */
            transition: background-color 0.3s; /* Smooth transition for background color */
        }

        td:hover {
            background-color: rgba(255, 255, 255, 0.708); 
            color: #0a0a0a;
        }
        .profile-section {
            width: 60%;
            margin: 20px auto;
            padding: 20px;
            background: #705b1b;
            border-radius: 8px;
            animation: slideIn 0.5s ease-out;
            
        }
        
        .profile-field {
            margin: 10px 0;
            font-size: 16px;
            animation: slideIn 1s ease-in-out;
            color: #f7f9f8;
            text-shadow: 1px 1px 5px rgba(0, 0, 0, 0.6);
            display: flex;
            justify-content: space-between;
            padding: 15px;
            border-bottom: 1px solid #444; /* Bottom border for each field */
            transition: background 0.3s;
        }
        .profile-field:hover {
            background: rgba(255, 255, 255, 0.1); /* Light hover effect */
            transform: scale(1.02); /* Slight scale effect on hover */
        }
        
        .profile-field span {
            font-size: 1.2em; /* Slightly larger text */
        }
        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }
        
        /* Slide in animation */
        @keyframes slideIn {
            from {
                transform: translateY(20px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
        .edit-btn {
            margin-top: 15px;
            padding: 8px 16px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background 0.3s, transform 0.3s;
            align-self: center; /* Center the button */

        }
        .edit-btn:hover {
            background: #e64a19; /* Darker orange on hover */
            transform: translateY(-2px); /* Slight lift effect on hover */
        }
        
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background: white;
            padding: 20px;
            border-radius: 8px;
            width: 400px;
            animation: slideIn 0.5s;
        }
        
        .form-group {
            margin: 15px 0;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        .form-group input {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        
        .button-group {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 20px;
        }
        
        .button-group button {
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .button-group button[type="submit"] {
            background: #28a745;
            color: white;
        }
        
        .button-group button[type="button"] {
            background: #dc3545;
            color: white;
        }
        .buttons button {
            margin-right: 10px;
        }
        .topics-list {
            list-style-type: none;
            padding: 0;
        }
        .topics-list li {
            cursor: pointer;
            margin: 5px 0;
        }
    </style>
</head>
<body>

    <div class="container">
        <h2 id="welcomeMessage">Welcome</h2>
        <div class="profile-section">
            <div class="profile-field">
                <span>Username:</span> 
                <span id="studentUsername"></span>
            </div>
            
            <div class="profile-field">
                <span>Full Name:</span>
                <span id="studentFullName"></span>
            </div>
            
            <div class="profile-field">
                <span>Email:</span>
                <span id="studentEmail"></span>
            </div>
            
            <div class="profile-field">
                <span>Branch:</span>
                <span id="studentBranch"></span>
            </div>
        
            <button id="editProfileBtn" class="edit-btn">Edit Profile</button>
        </div>
        <div id="editProfileModal" class="modal" style="display: none;">
            <div class="modal-content">
                <h2>Edit Profile</h2>
                <form id="editProfileForm">
                    <div class="form-group">
                        
                        <label for="editFullName">Username:</label>
                        <input type="text" id="editUserName" name="userName" required>
                    </div>
                    <div class="form-group">
                        
                        <label for="editFullName">Full Name:</label>
                        <input type="text" id="editFullName" name="fullName" required>
                    </div>
                    <div class="form-group">
                        <label for="editEmail">Email:</label>
                        <input type="email" id="editEmail" name="email" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="editBranch">Branch:</label>
                        <input type="text" id="editBranch" name="branch" required>
                    </div>
                    
                    <div class="button-group">
                        <button type="submit">Save </button>
                        <button type="button" id="cancelEdit">Cancel</button>
                    </div>
                </form>
            </div>
        </div>
        <h1>Attendance Percentage: 85%</h1>

        <div class="buttons">
            <button class=" tech" onclick="showTopics('technical')">Technical</button>
            <button class=" itech"onclick="showTopics('non-technical')">Non-Technical</button>
        </div>
    </div>

    <div class="topics-section">
        <div>
            <h2 id="topics-heading" style="display:none;">Topics</h2>
            <ul id="technical-topics" class="topics-list" style="display: none;">
                <li onclick="showTable('Python', '01-Oct-2024 to 10-Oct-2024')">Python</li>
                <li onclick="showTable('C Language', '15-Oct-2024 to 25-Oct-2024')">C Language</li>
                <li onclick="showTable('DSA', '01-Nov-2024 to 10-Nov-2024')">DSA</li>
                <li onclick="showTable('Computer Networks', '12-Nov-2024 to 22-Nov-2024')">Computer Networks</li>
                <li onclick="showTable('Java', '25-Nov-2024 to 05-Dec-2024')">Java</li>
                <li onclick="showTable('OOPS Concept', '07-Dec-2024 to 15-Dec-2024')">OOPS Concept</li>
                <li onclick="showTable('DBMS', '17-Dec-2024 to 27-Dec-2024')">DBMS</li>
                <li onclick="showTable('OS', '01-Jan-2025 to 10-Jan-2025')">OS</li>
            </ul>
            <ul id="non-technical-topics" class="topics-list" style="display: none;">
                <li onclick="showTable('Ratio and Proportion', '01-Oct-2024 to 05-Oct-2024')">Ratio and Proportion</li>
                <li onclick="showTable('Profit and Loss', '10-Oct-2024 to 15-Oct-2024')">Profit and Loss</li>
                <li onclick="showTable('Coding and Decoding', '20-Oct-2024 to 25-Oct-2024')">Coding and Decoding</li>
                <li onclick="showTable('Partnerships', '01-Nov-2024 to 05-Nov-2024')">Partnerships</li>
                <li onclick="showTable('LCM and HCF', '10-Nov-2024 to 15-Nov-2024')">LCM and HCF</li>
                <li onclick="showTable('Simple Interest', '20-Nov-2024 to 25-Nov-2024')">Simple Interest</li>
                <li onclick="showTable('Averages', '01-Dec-2024 to 05-Dec-2024')">Averages</li>
                <li onclick="showTable('Distance, Time and Speed', '10-Dec-2024 to 15-Dec-2024')">Distance, Time and Speed</li>
            </ul>
        </div>

        <div class="table-container" id="table-container" style="display:none;">
            <h2 id="topic-name"></h2>
            <table>
                <thead>
                    <tr>
                        <th>Dates</th>
                        <th>Conducted Classes</th>
                        <th>Attended Classes</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td id="topic-dates"></td>
                        <td>10</td>
                        <td>8</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <script>
        function showTopics(type) {
            document.getElementById('technical-topics').style.display = 'none';
            document.getElementById('non-technical-topics').style.display = 'none';
        
            const topicsHeading = document.getElementById('topics-heading');
            topicsHeading.style.display = 'none';
        
            if (type === 'technical') {
                document.getElementById('technical-topics').style.display = 'block';
                topicsHeading.style.display = 'block';  
            } else if (type === 'non-technical') {
                document.getElementById('non-technical-topics').style.display = 'block';
                topicsHeading.style.display = 'block';  // Show heading if non-technical topics are displayed
            }
        
            document.getElementById('table-container').style.display = 'none';
        }
        
        function showTable(topic, dates) {
            document.getElementById('topic-name').innerText = topic;
            document.getElementById('topic-dates').innerText = dates;
            document.getElementById('table-container').style.display = 'block';
        } 

    async function getuserdata() {
        try {
            const username = localStorage.getItem('username')
            const resp = await fetch(`/getStudentDetails?username=${username}`)
            if (!resp.ok) throw new Error(`Error: ${resp.status}`);
            const data = await resp.json();
            console.log(data)
            document.getElementById('welcomeMessage').innerText = `Welcome, ${data.fullName}`;

            document.getElementById("studentUsername").innerText = data.username;
            document.getElementById("studentFullName").innerText = data.fullName;
            document.getElementById("studentEmail").innerText = data.email;
            document.getElementById("studentBranch").innerText = data.branch;
        }catch(error) {
            console.error("Error fetching data:", error);
      }
        
    }
getuserdata()
document.addEventListener('DOMContentLoaded', function() {
    const editBtn = document.getElementById('editProfileBtn');
    const modal = document.getElementById('editProfileModal');
    const cancelBtn = document.getElementById('cancelEdit');
    const editForm = document.getElementById('editProfileForm');
    
    const username = localStorage.getItem('username');
    
    // Load initial profile data
    loadProfileData();
    
    editBtn.addEventListener('click', function() {
        document.getElementById('editUserName').value = document.getElementById("studentUsername").innerText;


        document.getElementById('editFullName').value = document.getElementById('studentFullName').textContent;
        document.getElementById('editEmail').value = document.getElementById('studentEmail').textContent;
        document.getElementById('editBranch').value = document.getElementById('studentBranch').textContent;
        modal.style.display = 'flex';
    });
    
    cancelBtn.addEventListener('click', function() {
        modal.style.display = 'none';
    });
    
    editForm.addEventListener('submit', function(e) {
        e.preventDefault();
        
        const formData = {
            username:username,
            username: document.getElementById('editUserName').value,
            fullName: document.getElementById('editFullName').value,
            email: document.getElementById('editEmail').value,
            branch: document.getElementById('editBranch').value
        };
        
        updateProfile(formData);
    });
    
    function loadProfileData() {
        fetch(`/getStudentDetails?username=${username}`)
            .then(response => response.json())
            .then(data => {
                document.getElementById('studentUsername').textContent = data.username;
                document.getElementById('studentFullName').textContent = data.fullName;
                document.getElementById('studentEmail').textContent = data.email;
                document.getElementById('studentBranch').textContent = data.branch;
            })
            .catch(error => console.error('Error loading profile:', error));
    }
    
    function updateProfile(formData) {
        fetch('/updateProfile', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(formData)
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                alert('Profile updated successfully!');
                modal.style.display = 'none';
                loadProfileData(); // Reload the profile data
            } else {
                alert(data.message || 'Error updating profile');
            }
        })
        .catch(error => {
            console.error('Error updating profile:', error);
            alert('Error updating profile');
        });
    }
});

    </script>

</body>
</html>